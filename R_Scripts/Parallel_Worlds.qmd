---
title: "Parallel Worlds"
author: "Francesco Prem Solidoro, Michele Salvi"
format: pdf
editor: visual
---

```{r}
library(tidyverse)
library(paletteer)
library(ggthemes)
library(knitr)
#| echo: false
```

```{r}
#importing, merging and cleaning

IRAtweets1 <- read.csv("C:/Users/hawkm/OneDrive/Desktop/R Projects/Big Data in Social Sciences/AstroTurfing/Data/IRAhandle_tweets_1.csv")
IRAtweets2 <- read.csv("C:/Users/hawkm/OneDrive/Desktop/R Projects/Big Data in Social Sciences/AstroTurfing/Data/IRAhandle_tweets_2.csv")
IRAtweets3 <- read.csv("C:/Users/hawkm/OneDrive/Desktop/R Projects/Big Data in Social Sciences/AstroTurfing/Data/IRAhandle_tweets_3.csv")
IRAtweets4 <- read.csv("C:/Users/hawkm/OneDrive/Desktop/R Projects/Big Data in Social Sciences/AstroTurfing/Data/IRAhandle_tweets_4.csv")
IRAtweets5 <- read.csv("C:/Users/hawkm/OneDrive/Desktop/R Projects/Big Data in Social Sciences/AstroTurfing/Data/IRAhandle_tweets_5.csv")
IRAtweets6 <- read.csv("C:/Users/hawkm/OneDrive/Desktop/R Projects/Big Data in Social Sciences/AstroTurfing/Data/IRAhandle_tweets_6.csv")
IRAtweets7 <- read.csv("C:/Users/hawkm/OneDrive/Desktop/R Projects/Big Data in Social Sciences/AstroTurfing/Data/IRAhandle_tweets_7.csv")
IRAtweets8 <- read.csv("C:/Users/hawkm/OneDrive/Desktop/R Projects/Big Data in Social Sciences/AstroTurfing/Data/IRAhandle_tweets_8.csv")
IRAtweets9 <- read.csv("C:/Users/hawkm/OneDrive/Desktop/R Projects/Big Data in Social Sciences/AstroTurfing/Data/IRAhandle_tweets_9.csv")
IRAtweets10 <- read.csv("C:/Users/hawkm/OneDrive/Desktop/R Projects/Big Data in Social Sciences/AstroTurfing/Data/IRAhandle_tweets_10.csv")
IRAtweets11 <- read.csv("C:/Users/hawkm/OneDrive/Desktop/R Projects/Big Data in Social Sciences/AstroTurfing/Data/IRAhandle_tweets_11.csv")
IRAtweets12 <- read.csv("C:/Users/hawkm/OneDrive/Desktop/R Projects/Big Data in Social Sciences/AstroTurfing/Data/IRAhandle_tweets_12.csv")
IRAtweets13 <- read.csv("C:/Users/hawkm/OneDrive/Desktop/R Projects/Big Data in Social Sciences/AstroTurfing/Data/IRAhandle_tweets_13.csv")

df_list <- list(IRAtweets1,IRAtweets2,IRAtweets3,IRAtweets4,IRAtweets5,IRAtweets6,IRAtweets7,IRAtweets8,IRAtweets9,IRAtweets10,IRAtweets11,IRAtweets12,IRAtweets13)

IRAtweets <- do.call("rbind", df_list)
IRAtweets <- subset(IRAtweets, select=c(-external_author_id,-harvested_date,-new_june_2018,-alt_external_id,-tweet_id,-article_url,-tco1_step1,-tco2_step1,-tco3_step1))

kable(head(IRAtweets))

#| echo: false
```

```{r}
#when comlpeted replace Test instances with IRAtweets
Test <- IRAtweets[sample(nrow(IRAtweets), 100000),]

mean_imp <-Test %>%
  select(c(author,updates,region,language)) %>% 
  group_by(author) %>%
  mutate(mean_Impressions = round(mean(updates),digits = 3)) %>%
  arrange(desc(mean_Impressions))

Lang_P <- Test %>% 
  group_by(language) %>%
  summarize(count = n())%>% 
  arrange(desc(count))%>%
  slice(1:6)%>%
  ungroup() %>%
  ggplot(aes(reorder(language, count),count/10000))+
  geom_bar(stat = "identity",fill = "darkblue")+
  coord_flip()+
  theme_bw()+
  labs(x = "Language", y = "Tweets (tens of thousands)", title = "Most Significant Languages")

Region_P <-  Test %>% 
  group_by(region) %>%
  summarize(count = n())%>% 
  arrange(desc(count))%>%
  slice(1:6)%>%
  ungroup() %>%
  ggplot(aes(reorder(region, count),count/10000))+
  geom_bar(stat = "identity", fill = "darkred")+
  coord_flip()+
  theme_bw()+
  labs(x = "Region", y = "Tweets (tens of thousands)", title = "Most Significant Regions")

totimp_mean <- mean(mean_imp$mean_Impressions)

Meanimp_P <- mean_imp %>%
  group_by(region)%>%
  add_count(region)%>% 
  ungroup() %>%
  mutate(rank = dense_rank(desc(n)))%>%
  filter(rank %in% 1:6)%>%
  ggplot(aes(mean_Impressions))+
  geom_histogram(aes(fill = region))+
  geom_vline(aes(xintercept=totimp_mean))+
  annotate("text", x=totimp_mean+3000, y=20000, label="Average ", angle = 90)+
  scale_fill_paletteer_d("nbapalettes::bucks_city2")+
  theme_bw()+
  labs(x = "Average impressions",y = "", title = "Average Tweet Impression for significant regions") 




Lang_P
Region_P
Meanimp_P



```
